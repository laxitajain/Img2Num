"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4776],{28453:(e,i,n)=>{n.d(i,{R:()=>a,x:()=>r});var s=n(96540);const l={},t=s.createContext(l);function a(e){const i=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),s.createElement(t.Provider,{value:i},e.children)}},99287:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>r,default:()=>o,frontMatter:()=>a,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"reference/wasm/modules/image/mergeSmallRegionsInPlace/faq","title":"FAQ","description":"Frequently asked questions related to the mergeSmallRegionsInPlace function.","source":"@site/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/faq.md","sourceDirName":"reference/wasm/modules/image/mergeSmallRegionsInPlace","slug":"/reference/wasm/modules/image/mergeSmallRegionsInPlace/faq","permalink":"/Img2Num/info/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/faq","draft":false,"unlisted":false,"editUrl":"https://github.com/Ryan-Millard/Img2Num/edit/main/docs/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/faq.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"id":"faq","title":"FAQ","sidebar_label":"FAQ","sidebar_position":10,"description":"Frequently asked questions related to the mergeSmallRegionsInPlace function."},"sidebar":"tutorialSidebar","previous":{"title":"Testing & Debugging Suggestions","permalink":"/Img2Num/info/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/testing-and-debugging-suggestions"},"next":{"title":"bilateral_filter.h","permalink":"/Img2Num/info/docs/reference/wasm/modules/image/bilateral_filter"}}');var l=n(74848),t=n(28453);const a={id:"faq",title:"FAQ",sidebar_label:"FAQ",sidebar_position:10,description:"Frequently asked questions related to the mergeSmallRegionsInPlace function."},r="Frequently Asked Questions",d={},h=[{value:"What problem does <code>mergeSmallRegionsInPlace</code> solve?",id:"what-problem-does-mergesmallregionsinplace-solve",level:2},{value:"What exactly is a \u201cregion\u201d in this context?",id:"what-exactly-is-a-region-in-this-context",level:2},{value:"Why use 4-connectivity instead of 8-connectivity?",id:"why-use-4-connectivity-instead-of-8-connectivity",level:2},{value:"Why is the image indexed as <code>idx(x, y, width) * 4</code>?",id:"why-is-the-image-indexed-as-idxx-y-width--4",level:2},{value:"What does <code>sameColor(...)</code> check?",id:"what-does-samecolor-check",level:2},{value:"Why does the algorithm do two passes?",id:"why-does-the-algorithm-do-two-passes",level:2},{value:"What makes a region \u201cbig enough\u201d?",id:"what-makes-a-region-big-enough",level:2},{value:"Why use a bounding box instead of checking shape quality?",id:"why-use-a-bounding-box-instead-of-checking-shape-quality",level:2},{value:"Can a region pass the bounding box test but still be \u201cbad\u201d?",id:"can-a-region-pass-the-bounding-box-test-but-still-be-bad",level:2},{value:"Why are regions merged pixel-by-pixel instead of as a whole?",id:"why-are-regions-merged-pixel-by-pixel-instead-of-as-a-whole",level:2},{value:"Why only check immediate neighbors during merging?",id:"why-only-check-immediate-neighbors-during-merging",level:2},{value:"What happens if a small region has no big neighbors?",id:"what-happens-if-a-small-region-has-no-big-neighbors",level:2},{value:"Does this update region metadata after merging?",id:"does-this-update-region-metadata-after-merging",level:2},{value:"What is the time complexity?",id:"what-is-the-time-complexity",level:2},{value:"What is the memory overhead?",id:"what-is-the-memory-overhead",level:2},{value:"Why use BFS (<code>std::queue</code>) instead of DFS?",id:"why-use-bfs-stdqueue-instead-of-dfs",level:2},{value:"Can this function be parallelized?",id:"can-this-function-be-parallelized",level:2},{value:"Is this suitable for SVG generation pipelines?",id:"is-this-suitable-for-svg-generation-pipelines",level:2},{value:"What are common improvements or extensions?",id:"what-are-common-improvements-or-extensions",level:2},{value:"Is this function deterministic?",id:"is-this-function-deterministic",level:2},{value:"When should I <em>not</em> use this?",id:"when-should-i-not-use-this",level:2}];function c(e){const i={admonition:"admonition",annotation:"annotation",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",mtext:"mtext",ol:"ol",p:"p",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,t.R)(),...e.components},{Details:n}=i;return n||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.header,{children:(0,l.jsx)(i.h1,{id:"frequently-asked-questions",children:"Frequently Asked Questions"})}),"\n",(0,l.jsxs)(i.h2,{id:"what-problem-does-mergesmallregionsinplace-solve",children:["What problem does ",(0,l.jsx)(i.code,{children:"mergeSmallRegionsInPlace"})," solve?"]}),"\n",(0,l.jsxs)(i.p,{children:["This function removes ",(0,l.jsx)(i.strong,{children:"tiny connected regions"})," in an RGBA image by merging them into neighboring, sufficiently large regions ",(0,l.jsx)(i.strong,{children:"in-place"}),"."]}),"\n",(0,l.jsx)(i.p,{children:"It is intended for post-processing steps after:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"k-means color quantization"}),"\n",(0,l.jsx)(i.li,{children:"segmentation"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Or as a pre-processing step before:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"image-to-vector (SVG) pipelines"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Small regions often appear as visual noise and make downstream geometry extraction harder."}),"\n",(0,l.jsx)(i.h2,{id:"what-exactly-is-a-region-in-this-context",children:"What exactly is a \u201cregion\u201d in this context?"}),"\n",(0,l.jsxs)(i.p,{children:["A ",(0,l.jsx)(i.strong,{children:"region"})," is a ",(0,l.jsx)(i.em,{children:"4-connected component"})," of pixels where:"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Each pixel is connected via ",(0,l.jsx)(i.strong,{children:"up, down, left, or right"})]}),"\n",(0,l.jsxs)(i.li,{children:["All pixels have ",(0,l.jsx)(i.strong,{children:"exactly the same RGBA values"})]}),"\n"]}),"\n",(0,l.jsxs)(i.p,{children:["Diagonal adjacency ",(0,l.jsx)(i.strong,{children:"does not"})," count."]}),"\n",(0,l.jsx)(i.h2,{id:"why-use-4-connectivity-instead-of-8-connectivity",children:"Why use 4-connectivity instead of 8-connectivity?"}),"\n",(0,l.jsx)(i.p,{children:"4-connectivity:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Matches most raster algorithms (flood-fill, contour tracing)"}),"\n",(0,l.jsx)(i.li,{children:"Avoids diagonal \u201ccorner-touch\u201d artifacts"}),"\n",(0,l.jsx)(i.li,{children:"Produces cleaner, grid-aligned regions"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Using 8-connectivity would merge diagonally touching pixels that visually are not part of the same region."}),"\n",(0,l.jsxs)(i.h2,{id:"why-is-the-image-indexed-as-idxx-y-width--4",children:["Why is the image indexed as ",(0,l.jsx)(i.code,{children:"idx(x, y, width) * 4"}),"?"]}),"\n",(0,l.jsxs)(i.p,{children:["Each pixel consists of ",(0,l.jsx)(i.strong,{children:"4 bytes"}),": ",(0,l.jsx)(i.code,{children:"R"}),", ",(0,l.jsx)(i.code,{children:"G"}),", ",(0,l.jsx)(i.code,{children:"B"}),", ",(0,l.jsx)(i.code,{children:"A"})]}),"\n",(0,l.jsx)(i.p,{children:"So the linear index into the pixel buffer is:"}),"\n",(0,l.jsx)(i.span,{className:"katex-display",children:(0,l.jsxs)(i.span,{className:"katex",children:[(0,l.jsx)(i.span,{className:"katex-mathml",children:(0,l.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(i.semantics,{children:[(0,l.jsxs)(i.mrow,{children:[(0,l.jsx)(i.mo,{stretchy:"false",children:"("}),(0,l.jsx)(i.mtext,{children:"y"}),(0,l.jsx)(i.mo,{children:"\u22c5"}),(0,l.jsx)(i.mtext,{children:"width"}),(0,l.jsx)(i.mo,{children:"+"}),(0,l.jsx)(i.mtext,{children:"x"}),(0,l.jsx)(i.mo,{stretchy:"false",children:")"}),(0,l.jsx)(i.mo,{children:"\xd7"}),(0,l.jsx)(i.mn,{children:"4"})]}),(0,l.jsx)(i.annotation,{encoding:"application/x-tex",children:"(\\text{y} \\cdot \\text{width} + \\text{x}) \\times 4"})]})})}),(0,l.jsxs)(i.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(i.span,{className:"mopen",children:"("}),(0,l.jsx)(i.span,{className:"mord text",children:(0,l.jsx)(i.span,{className:"mord",children:"y"})}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(i.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(i.span,{className:"mord text",children:(0,l.jsx)(i.span,{className:"mord",children:"width"})}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(i.span,{className:"mbin",children:"+"}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(i.span,{className:"mord text",children:(0,l.jsx)(i.span,{className:"mord",children:"x"})}),(0,l.jsx)(i.span,{className:"mclose",children:")"}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(i.span,{className:"mbin",children:"\xd7"}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"0.6444em"}}),(0,l.jsx)(i.span,{className:"mord",children:"4"})]})]})]})}),"\n",(0,l.jsxs)(n,{children:[(0,l.jsx)("summary",{children:"Visual Example: 5\xd75 RGBA Image Indexing"}),(0,l.jsxs)("svg",{width:"300",height:"340",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("rect",{x:"0",y:"0",width:"320",height:"340",fill:"#eeeeee"}),(0,l.jsx)("rect",{x:"0",y:"0",width:"60",height:"60",fill:"#ffd6d6",stroke:"#000"}),(0,l.jsx)("text",{x:"30",y:"35","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(0,0) idx*4=0"}),(0,l.jsx)("rect",{x:"60",y:"0",width:"60",height:"60",fill:"#d6ffd6",stroke:"#000"}),(0,l.jsx)("text",{x:"90",y:"35","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(1,0) idx*4=4"}),(0,l.jsx)("rect",{x:"120",y:"0",width:"60",height:"60",fill:"#d6d6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"150",y:"35","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(2,0) idx*4=8"}),(0,l.jsx)("rect",{x:"180",y:"0",width:"60",height:"60",fill:"#fff0d6",stroke:"#000"}),(0,l.jsx)("text",{x:"210",y:"35","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(3,0) idx*4=12"}),(0,l.jsx)("rect",{x:"240",y:"0",width:"60",height:"60",fill:"#ffd6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"270",y:"35","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(4,0) idx*4=16"}),(0,l.jsx)("rect",{x:"0",y:"60",width:"60",height:"60",fill:"#d6ffd6",stroke:"#000"}),(0,l.jsx)("text",{x:"30",y:"95","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(0,1) idx*4=20"}),(0,l.jsx)("rect",{x:"60",y:"60",width:"60",height:"60",fill:"#d6d6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"90",y:"95","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(1,1) idx*4=24"}),(0,l.jsx)("rect",{x:"120",y:"60",width:"60",height:"60",fill:"#fff0d6",stroke:"#000"}),(0,l.jsx)("text",{x:"150",y:"95","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(2,1) idx*4=28"}),(0,l.jsx)("rect",{x:"180",y:"60",width:"60",height:"60",fill:"#ffd6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"210",y:"95","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(3,1) idx*4=32"}),(0,l.jsx)("rect",{x:"240",y:"60",width:"60",height:"60",fill:"#ffd6d6",stroke:"#000"}),(0,l.jsx)("text",{x:"270",y:"95","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(4,1) idx*4=36"}),(0,l.jsx)("rect",{x:"0",y:"120",width:"60",height:"60",fill:"#d6d6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"30",y:"155","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(0,2) idx*4=40"}),(0,l.jsx)("rect",{x:"60",y:"120",width:"60",height:"60",fill:"#fff0d6",stroke:"#000"}),(0,l.jsx)("text",{x:"90",y:"155","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(1,2) idx*4=44"}),(0,l.jsx)("rect",{x:"120",y:"120",width:"60",height:"60",fill:"#ffd6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"150",y:"155","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(2,2) idx*4=48"}),(0,l.jsx)("rect",{x:"180",y:"120",width:"60",height:"60",fill:"#ffd6d6",stroke:"#000"}),(0,l.jsx)("text",{x:"210",y:"155","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(3,2) idx*4=52"}),(0,l.jsx)("rect",{x:"240",y:"120",width:"60",height:"60",fill:"#d6ffd6",stroke:"#000"}),(0,l.jsx)("text",{x:"270",y:"155","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(4,2) idx*4=56"}),(0,l.jsx)("rect",{x:"0",y:"180",width:"60",height:"60",fill:"#fff0d6",stroke:"#000"}),(0,l.jsx)("text",{x:"30",y:"215","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(0,3) idx*4=60"}),(0,l.jsx)("rect",{x:"60",y:"180",width:"60",height:"60",fill:"#ffd6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"90",y:"215","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(1,3) idx*4=64"}),(0,l.jsx)("rect",{x:"120",y:"180",width:"60",height:"60",fill:"#ffd6d6",stroke:"#000"}),(0,l.jsx)("text",{x:"150",y:"215","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(2,3) idx*4=68"}),(0,l.jsx)("rect",{x:"180",y:"180",width:"60",height:"60",fill:"#d6ffd6",stroke:"#000"}),(0,l.jsx)("text",{x:"210",y:"215","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(3,3) idx*4=72"}),(0,l.jsx)("rect",{x:"240",y:"180",width:"60",height:"60",fill:"#d6d6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"270",y:"215","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(4,3) idx*4=76"}),(0,l.jsx)("rect",{x:"0",y:"240",width:"60",height:"60",fill:"#ffd6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"30",y:"275","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(0,4) idx*4=80"}),(0,l.jsx)("rect",{x:"60",y:"240",width:"60",height:"60",fill:"#ffd6d6",stroke:"#000"}),(0,l.jsx)("text",{x:"90",y:"275","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(1,4) idx*4=84"}),(0,l.jsx)("rect",{x:"120",y:"240",width:"60",height:"60",fill:"#d6ffd6",stroke:"#000"}),(0,l.jsx)("text",{x:"150",y:"275","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(2,4) idx*4=88"}),(0,l.jsx)("rect",{x:"180",y:"240",width:"60",height:"60",fill:"#d6d6ff",stroke:"#000"}),(0,l.jsx)("text",{x:"210",y:"275","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(3,4) idx*4=92"}),(0,l.jsx)("rect",{x:"240",y:"240",width:"60",height:"60",fill:"#fff0d6",stroke:"#000"}),(0,l.jsx)("text",{x:"270",y:"275","font-size":"8","text-anchor":"middle","alignment-baseline":"middle",children:"(4,4) idx*4=96"}),(0,l.jsx)("text",{x:"80",y:"320","font-size":"10",children:"Each pixel = 4 bytes (R,G,B,A)"}),(0,l.jsx)("text",{x:"80",y:"335","font-size":"10",children:"Byte offset = idx(x,y,width) * 4"})]})]}),"\n",(0,l.jsx)(i.admonition,{title:"Assumptions this layout has",type:"note",children:(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Row-major order"}),"\n",(0,l.jsx)(i.li,{children:"No padding between rows"}),"\n"]})}),"\n",(0,l.jsxs)(i.h2,{id:"what-does-samecolor-check",children:["What does ",(0,l.jsx)(i.code,{children:"sameColor(...)"})," check?"]}),"\n",(0,l.jsxs)(i.p,{children:["It compares ",(0,l.jsx)(i.strong,{children:"all four RGBA channels"})," for equality:"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Red"}),"\n",(0,l.jsx)(i.li,{children:"Green"}),"\n",(0,l.jsx)(i.li,{children:"Blue"}),"\n",(0,l.jsx)(i.li,{children:"Alpha"}),"\n"]}),"\n",(0,l.jsxs)(i.p,{children:["Two pixels are considered connected ",(0,l.jsx)(i.strong,{children:"only if all channels match exactly"}),"."]}),"\n",(0,l.jsx)(i.p,{children:"This is important for correctness when alpha is meaningful (e.g. transparency)."}),"\n",(0,l.jsx)(i.h2,{id:"why-does-the-algorithm-do-two-passes",children:"Why does the algorithm do two passes?"}),"\n",(0,l.jsxs)(i.p,{children:["The function is split into ",(0,l.jsx)(i.strong,{children:"two distinct phases"}),":"]}),"\n",(0,l.jsxs)(i.ol,{children:["\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Labeling pass"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Flood-fills each region"}),"\n",(0,l.jsx)(i.li,{children:"Assigns a label to every pixel"}),"\n",(0,l.jsx)(i.li,{children:"Computes region metadata (area + bounding box)"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsx)(i.p,{children:(0,l.jsx)(i.strong,{children:"Merge pass"})}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Iterates pixels again"}),"\n",(0,l.jsx)(i.li,{children:"Replaces pixels belonging to \u201csmall\u201d regions"}),"\n",(0,l.jsx)(i.li,{children:"Copies color from a neighboring \u201cbig enough\u201d region"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"This separation keeps the logic simpler and avoids modifying regions while still discovering them."}),"\n",(0,l.jsx)(i.h2,{id:"what-makes-a-region-big-enough",children:"What makes a region \u201cbig enough\u201d?"}),"\n",(0,l.jsxs)(i.p,{children:["A region must satisfy ",(0,l.jsx)(i.strong,{children:"all three"})," conditions:"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.code,{children:"size >= minArea"})}),"\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.code,{children:"width() >= minWidth"})}),"\n",(0,l.jsx)(i.li,{children:(0,l.jsx)(i.code,{children:"height() >= minHeight"})}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Where:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"size"})," = number of pixels"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"width()"})," = bounding box width"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"height()"})," = bounding box height"]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"This prevents:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Thin lines"}),"\n",(0,l.jsx)(i.li,{children:"Long but narrow artifacts"}),"\n",(0,l.jsx)(i.li,{children:"Small blobs"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"why-use-a-bounding-box-instead-of-checking-shape-quality",children:"Why use a bounding box instead of checking shape quality?"}),"\n",(0,l.jsx)(i.p,{children:"Bounding boxes are:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Fast to compute"}),"\n",(0,l.jsx)(i.li,{children:"Memory cheap"}),"\n",(0,l.jsx)(i.li,{children:"Conservative"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"They don\u2019t capture holes or concavities, but they are a good heuristic for filtering obvious noise."}),"\n",(0,l.jsxs)(i.p,{children:["There is a TODO noting that ",(0,l.jsx)(i.strong,{children:"internal gaps"})," could reduce effective width/height even if the bounding box looks valid."]}),"\n",(0,l.jsx)(i.h2,{id:"can-a-region-pass-the-bounding-box-test-but-still-be-bad",children:"Can a region pass the bounding box test but still be \u201cbad\u201d?"}),"\n",(0,l.jsx)(i.p,{children:"Yes."}),"\n",(0,l.jsx)(i.p,{children:"Example:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"A hollow ring"}),"\n",(0,l.jsx)(i.li,{children:"A U-shaped region"}),"\n",(0,l.jsx)(i.li,{children:"A region with internal gaps"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"The bounding box may be large, but the actual filled area might be sparse."}),"\n",(0,l.jsx)(i.p,{children:"This implementation prioritizes speed and simplicity over perfect geometric validity."}),"\n",(0,l.jsx)(i.h2,{id:"why-are-regions-merged-pixel-by-pixel-instead-of-as-a-whole",children:"Why are regions merged pixel-by-pixel instead of as a whole?"}),"\n",(0,l.jsx)(i.p,{children:"Because:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["The function operates ",(0,l.jsx)(i.strong,{children:"in-place"})]}),"\n",(0,l.jsx)(i.li,{children:"It avoids reallocating buffers"}),"\n",(0,l.jsx)(i.li,{children:"It keeps memory usage predictable"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Each pixel independently:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Checks its neighbors"}),"\n",(0,l.jsx)(i.li,{children:"Copies the color of a valid region"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"This makes the merge phase linear and simple."}),"\n",(0,l.jsx)(i.h2,{id:"why-only-check-immediate-neighbors-during-merging",children:"Why only check immediate neighbors during merging?"}),"\n",(0,l.jsxs)(i.p,{children:["Only ",(0,l.jsx)(i.strong,{children:"4 immediate neighbors"})," are checked because:"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"The merge should respect spatial adjacency"}),"\n",(0,l.jsx)(i.li,{children:"Copying from distant pixels could create visual artifacts"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"This ensures merges look natural and locally consistent."}),"\n",(0,l.jsx)(i.h2,{id:"what-happens-if-a-small-region-has-no-big-neighbors",children:"What happens if a small region has no big neighbors?"}),"\n",(0,l.jsx)(i.p,{children:"Nothing."}),"\n",(0,l.jsx)(i.p,{children:"Pixels in that region remain unchanged."}),"\n",(0,l.jsx)(i.p,{children:"This avoids:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Arbitrary color assignment"}),"\n",(0,l.jsx)(i.li,{children:"Unexpected long-range merges"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"If this is undesirable, a second pass or fallback strategy can be added."}),"\n",(0,l.jsx)(i.h2,{id:"does-this-update-region-metadata-after-merging",children:"Does this update region metadata after merging?"}),"\n",(0,l.jsx)(i.p,{children:"No."}),"\n",(0,l.jsx)(i.p,{children:"Once the merge phase starts:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"regions"})," is treated as read-only"]}),"\n",(0,l.jsx)(i.li,{children:"Labels may change per pixel"}),"\n",(0,l.jsxs)(i.li,{children:["Region sizes are ",(0,l.jsx)(i.strong,{children:"not recomputed"})]}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"This is intentional to keep runtime linear and avoid cascading changes."}),"\n",(0,l.jsx)(i.h2,{id:"what-is-the-time-complexity",children:"What is the time complexity?"}),"\n",(0,l.jsxs)(i.p,{children:["Overall complexity is ",(0,l.jsx)(i.strong,{children:"linear"}),":"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["Flood-fill labeling: ",(0,l.jsxs)(i.span,{className:"katex",children:[(0,l.jsx)(i.span,{className:"katex-mathml",children:(0,l.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(i.semantics,{children:[(0,l.jsxs)(i.mrow,{children:[(0,l.jsx)(i.mi,{children:"O"}),(0,l.jsx)(i.mo,{stretchy:"false",children:"("}),(0,l.jsx)(i.mi,{children:"n"}),(0,l.jsx)(i.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(i.annotation,{encoding:"application/x-tex",children:"O(n)"})]})})}),(0,l.jsx)(i.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(i.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,l.jsx)(i.span,{className:"mopen",children:"("}),(0,l.jsx)(i.span,{className:"mord mathnormal",children:"n"}),(0,l.jsx)(i.span,{className:"mclose",children:")"})]})})]})]}),"\n",(0,l.jsxs)(i.li,{children:["Merge pass: ",(0,l.jsxs)(i.span,{className:"katex",children:[(0,l.jsx)(i.span,{className:"katex-mathml",children:(0,l.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(i.semantics,{children:[(0,l.jsxs)(i.mrow,{children:[(0,l.jsx)(i.mi,{children:"O"}),(0,l.jsx)(i.mo,{stretchy:"false",children:"("}),(0,l.jsx)(i.mi,{children:"n"}),(0,l.jsx)(i.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(i.annotation,{encoding:"application/x-tex",children:"O(n)"})]})})}),(0,l.jsx)(i.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(i.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),(0,l.jsx)(i.span,{className:"mopen",children:"("}),(0,l.jsx)(i.span,{className:"mord mathnormal",children:"n"}),(0,l.jsx)(i.span,{className:"mclose",children:")"})]})})]})]}),"\n"]}),"\n",(0,l.jsxs)(i.p,{children:["Where ",(0,l.jsxs)(i.span,{className:"katex",children:[(0,l.jsx)(i.span,{className:"katex-mathml",children:(0,l.jsx)(i.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(i.semantics,{children:[(0,l.jsxs)(i.mrow,{children:[(0,l.jsx)(i.mi,{children:"n"}),(0,l.jsx)(i.mo,{children:"="}),(0,l.jsx)(i.mtext,{children:"width"}),(0,l.jsx)(i.mo,{children:"\xd7"}),(0,l.jsx)(i.mtext,{children:"height"})]}),(0,l.jsx)(i.annotation,{encoding:"application/x-tex",children:"n = \\text{width} \\times \\text{height}"})]})})}),(0,l.jsxs)(i.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"0.4306em"}}),(0,l.jsx)(i.span,{className:"mord mathnormal",children:"n"}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(i.span,{className:"mrel",children:"="}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"0.7778em",verticalAlign:"-0.0833em"}}),(0,l.jsx)(i.span,{className:"mord text",children:(0,l.jsx)(i.span,{className:"mord",children:"width"})}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(i.span,{className:"mbin",children:"\xd7"}),(0,l.jsx)(i.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(i.span,{className:"base",children:[(0,l.jsx)(i.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,l.jsx)(i.span,{className:"mord text",children:(0,l.jsx)(i.span,{className:"mord",children:"height"})})]})]})]})]}),"\n",(0,l.jsx)(i.p,{children:"Each pixel is:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Visited once in flood-fill"}),"\n",(0,l.jsx)(i.li,{children:"Checked against at most 4 neighbors"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"what-is-the-memory-overhead",children:"What is the memory overhead?"}),"\n",(0,l.jsx)(i.p,{children:"Additional memory used:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"labels"}),": one ",(0,l.jsx)(i.code,{children:"int"})," per pixel"]}),"\n",(0,l.jsxs)(i.li,{children:[(0,l.jsx)(i.code,{children:"regions"}),": one entry per connected component"]}),"\n",(0,l.jsx)(i.li,{children:"BFS queue (temporary)"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"No additional image buffers are allocated."}),"\n",(0,l.jsxs)(i.h2,{id:"why-use-bfs-stdqueue-instead-of-dfs",children:["Why use BFS (",(0,l.jsx)(i.code,{children:"std::queue"}),") instead of DFS?"]}),"\n",(0,l.jsx)(i.p,{children:"BFS:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Avoids deep recursion"}),"\n",(0,l.jsx)(i.li,{children:"Prevents stack overflow on large regions"}),"\n",(0,l.jsx)(i.li,{children:"Has predictable memory usage"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"DFS would require either recursion (unsafe) or an explicit stack (no advantage here)."}),"\n",(0,l.jsx)(i.h2,{id:"can-this-function-be-parallelized",children:"Can this function be parallelized?"}),"\n",(0,l.jsx)(i.p,{children:"Not easily in its current form."}),"\n",(0,l.jsx)(i.p,{children:"Reasons:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Flood-fill has data dependencies"}),"\n",(0,l.jsx)(i.li,{children:"Label assignment is sequential"}),"\n",(0,l.jsx)(i.li,{children:"Merge step mutates shared data"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Parallel versions would require:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Tiled processing"}),"\n",(0,l.jsx)(i.li,{children:"Boundary reconciliation"}),"\n",(0,l.jsx)(i.li,{children:"More complex region merging logic"}),"\n"]}),"\n",(0,l.jsx)(i.h2,{id:"is-this-suitable-for-svg-generation-pipelines",children:"Is this suitable for SVG generation pipelines?"}),"\n",(0,l.jsxs)(i.p,{children:["Yes \u2014 especially as a ",(0,l.jsx)(i.strong,{children:"cleanup step"})," before:"]}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"Boundary tracing"}),"\n",(0,l.jsx)(i.li,{children:"Polygon extraction"}),"\n",(0,l.jsx)(i.li,{children:"Path simplification"}),"\n"]}),"\n",(0,l.jsx)(i.p,{children:"Removing small regions early greatly simplifies vector geometry later."}),"\n",(0,l.jsx)(i.h2,{id:"what-are-common-improvements-or-extensions",children:"What are common improvements or extensions?"}),"\n",(0,l.jsx)(i.p,{children:"Possible enhancements include:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsx)(i.p,{children:"Detecting holes inside regions"}),"\n",(0,l.jsxs)("svg",{width:"120",height:"120",viewBox:"0 0 120 120",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("rect",{x:"10",y:"10",width:"100",height:"100",fill:"#ffd6d6",stroke:"#000"}),(0,l.jsx)("rect",{x:"40",y:"40",width:"40",height:"40",fill:"#ffffff",stroke:"#000","stroke-dasharray":"4"})]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsx)(i.p,{children:"Merging based on color similarity instead of equality"}),"\n",(0,l.jsxs)("svg",{width:"180",height:"60",viewBox:"0 0 180 60",xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("rect",{x:"0",y:"0",width:"60",height:"60",fill:"#ffaaaa",stroke:"#000"}),(0,l.jsx)("rect",{x:"60",y:"0",width:"60",height:"60",fill:"#ff9999",stroke:"#000"}),(0,l.jsx)("rect",{x:"120",y:"0",width:"60",height:"60",fill:"#ff8888",stroke:"#000"})]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsx)(i.p,{children:"Multi-pass merging"}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsxs)(i.p,{children:["Choosing the ",(0,l.jsx)(i.em,{children:"largest neighboring region"})," instead of the first valid one"]}),"\n"]}),"\n",(0,l.jsxs)(i.li,{children:["\n",(0,l.jsx)(i.p,{children:"Detecting localised width/height - regions often have large tentacle-like protrusions."}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(i.p,{children:["The current design favors ",(0,l.jsx)(i.strong,{children:"clarity and predictability"})," over heuristics."]}),"\n",(0,l.jsx)(i.h2,{id:"is-this-function-deterministic",children:"Is this function deterministic?"}),"\n",(0,l.jsx)(i.p,{children:"Yes."}),"\n",(0,l.jsx)(i.p,{children:"Given the same input image and parameters, the output is always identical."}),"\n",(0,l.jsx)(i.p,{children:"No randomness is involved."}),"\n",(0,l.jsxs)(i.h2,{id:"when-should-i-not-use-this",children:["When should I ",(0,l.jsx)(i.em,{children:"not"})," use this?"]}),"\n",(0,l.jsx)(i.p,{children:"Avoid this function if:"}),"\n",(0,l.jsxs)(i.ul,{children:["\n",(0,l.jsx)(i.li,{children:"You need exact topology preservation"}),"\n",(0,l.jsx)(i.li,{children:"You rely on diagonal connectivity"}),"\n",(0,l.jsx)(i.li,{children:"You require sub-pixel or fuzzy color matching"}),"\n"]}),"\n",(0,l.jsxs)(i.p,{children:["It is designed for ",(0,l.jsx)(i.strong,{children:"grid-aligned, exact-color regions"}),"."]}),"\n",(0,l.jsx)(i.h1,{id:"summary",children:"Summary"}),"\n",(0,l.jsxs)(i.p,{children:[(0,l.jsx)(i.code,{children:"mergeSmallRegionsInPlace"})," is a fast, predictable cleanup step for raster segmentation pipelines.",(0,l.jsx)(i.br,{}),"\n","It trades geometric perfection for simplicity, performance, and ease of reasoning \u2014 which is often exactly what you want before vectorization."]})]})}function o(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,l.jsx)(i,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}}}]);