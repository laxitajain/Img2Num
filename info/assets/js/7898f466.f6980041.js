"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[3563],{28453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>r});var i=n(96540);const a={},l=i.createContext(a);function t(e){const s=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),i.createElement(l.Provider,{value:s},e.children)}},96235:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>m,contentTitle:()=>r,default:()=>d,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"reference/wasm/modules/image/mergeSmallRegionsInPlace/variants-and-improvements","title":"Variants & Improvements","description":"Several ways mergeSmallRegionsInPlace could be improved or customized.","source":"@site/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/variants-and-improvements.md","sourceDirName":"reference/wasm/modules/image/mergeSmallRegionsInPlace","slug":"/reference/wasm/modules/image/mergeSmallRegionsInPlace/variants-and-improvements","permalink":"/Img2Num/info/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/variants-and-improvements","draft":false,"unlisted":false,"editUrl":"https://github.com/Ryan-Millard/Img2Num/edit/main/docs/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/variants-and-improvements.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"id":"variants-and-improvements","title":"Variants & Improvements","sidebar_label":"Variants & Improvements","sidebar_position":8,"description":"Several ways mergeSmallRegionsInPlace could be improved or customized."},"sidebar":"tutorialSidebar","previous":{"title":"Limitations & Pitfalls","permalink":"/Img2Num/info/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/limitations-and-pitfalls"},"next":{"title":"Testing & Debugging Suggestions","permalink":"/Img2Num/info/docs/reference/wasm/modules/image/mergeSmallRegionsInPlace/testing-and-debugging-suggestions"}}');var a=n(74848),l=n(28453);const t={id:"variants-and-improvements",title:"Variants & Improvements",sidebar_label:"Variants & Improvements",sidebar_position:8,description:"Several ways mergeSmallRegionsInPlace could be improved or customized."},r=void 0,m={},o=[{value:"8-connectivity",id:"8-connectivity",level:2},{value:"Two-pass connected-component",id:"two-pass-connected-component",level:2},{value:"Use colour distance instead of exact equality",id:"use-colour-distance-instead-of-exact-equality",level:2},{value:"Merge-by-nearest-large-region (instead of neighbour sampling)",id:"merge-by-nearest-large-region-instead-of-neighbour-sampling",level:2},{value:"Use morphological operations to fill small gaps",id:"use-morphological-operations-to-fill-small-gaps",level:2},{value:"Occupancy / solidity test",id:"occupancy--solidity-test",level:2},{value:"Parallel labeling",id:"parallel-labeling",level:2}];function c(e){const s={a:"a",admonition:"admonition",annotation:"annotation",blockquote:"blockquote",code:"code",h2:"h2",math:"math",mfrac:"mfrac",mi:"mi",mo:"mo",mrow:"mrow",p:"p",pre:"pre",semantics:"semantics",span:"span",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:["This section explains several ways to improve or customize the behavior of ",(0,a.jsx)(s.code,{children:"mergeSmallRegionsInPlace"}),"."]}),"\n",(0,a.jsx)(s.admonition,{title:"Limitations & Pitfalls",type:"tip",children:(0,a.jsxs)(s.p,{children:["Also see the previous section, ",(0,a.jsx)(s.a,{href:"../limitations-and-pitfalls",children:"Limitations & Pitfalls"}),", for a better understanding of the below."]})}),"\n",(0,a.jsx)(s.h2,{id:"8-connectivity",children:"8-connectivity"}),"\n",(0,a.jsx)(s.p,{children:"Change the neighbor offsets from 4 to 8 directions (include diagonals). This connects diagonally touching pixels."}),"\n",(0,a.jsx)(s.h2,{id:"two-pass-connected-component",children:"Two-pass connected-component"}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsx)(s.p,{children:"A.K.A. scanline or union-find labeling"}),"\n"]}),"\n",(0,a.jsx)(s.p,{children:"A two-pass algorithm is usually faster (lower memory footprint and better cache locality).\nIt scans rows, assigns provisional labels and records equivalences, then resolves equivalences and computes final region stats in the second pass."}),"\n",(0,a.jsx)(s.h2,{id:"use-colour-distance-instead-of-exact-equality",children:"Use colour distance instead of exact equality"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-cpp",metastring:'title="Replace sameColor with something like the below"',children:"inline bool similarColor(const uint8_t *img, int w, int h, int x1, int y1, int x2, int y2, int tol) {\n  int i1 = idx(x1,y1,w)*4; int i2 = idx(x2,y2,w)*4;\n  int dr = int(img[i1]) - img[i2];\n  int dg = int(img[i1+1]) - img[i2+1];\n  int db = int(img[i1+2]) - img[i2+2];\n  return (dr*dr + dg*dg + db*db) <= tol*tol;\n}\n"})}),"\n",(0,a.jsxs)(s.p,{children:["This treats colors within ",(0,a.jsx)(s.code,{children:"tol"})," distance as identical."]}),"\n",(0,a.jsx)(s.h2,{id:"merge-by-nearest-large-region-instead-of-neighbour-sampling",children:"Merge-by-nearest-large-region (instead of neighbour sampling)"}),"\n",(0,a.jsx)(s.p,{children:"For each small region, find the nearest big region (e.g. by computing region adjacency graph or distance transform)\nand recolor the whole small region at once. This reduces order dependence and makes merging decisions global."}),"\n",(0,a.jsx)(s.h2,{id:"use-morphological-operations-to-fill-small-gaps",children:"Use morphological operations to fill small gaps"}),"\n",(0,a.jsx)(s.p,{children:"Applying a morphological closing (dilate then erode) before connected-component labeling can fill thin gaps and reduce speckles without per-component heuristics."}),"\n",(0,a.jsx)(s.h2,{id:"occupancy--solidity-test",children:"Occupancy / solidity test"}),"\n",(0,a.jsxs)(s.p,{children:["Compute ",(0,a.jsxs)(s.span,{className:"katex",children:[(0,a.jsx)(s.span,{className:"katex-mathml",children:(0,a.jsx)(s.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(s.semantics,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mi,{children:"o"}),(0,a.jsx)(s.mi,{children:"l"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"d"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsx)(s.mi,{children:"y"}),(0,a.jsx)(s.mo,{children:"="}),(0,a.jsxs)(s.mfrac,{children:[(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"s"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"z"}),(0,a.jsx)(s.mi,{children:"e"})]}),(0,a.jsxs)(s.mrow,{children:[(0,a.jsx)(s.mi,{children:"w"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"d"}),(0,a.jsx)(s.mi,{children:"t"}),(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mo,{children:"\xd7"}),(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mi,{children:"e"}),(0,a.jsx)(s.mi,{children:"i"}),(0,a.jsx)(s.mi,{children:"g"}),(0,a.jsx)(s.mi,{children:"h"}),(0,a.jsx)(s.mi,{children:"t"})]})]})]}),(0,a.jsx)(s.annotation,{encoding:"application/x-tex",children:"solidity = \\frac{size}{width \\times height}"})]})})}),(0,a.jsxs)(s.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"so"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"l"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"d"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal",children:"t"}),(0,a.jsx)(s.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(s.span,{className:"mrel",children:"="}),(0,a.jsx)(s.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(s.span,{className:"base",children:[(0,a.jsx)(s.span,{className:"strut",style:{height:"1.3368em",verticalAlign:"-0.4811em"}}),(0,a.jsxs)(s.span,{className:"mord",children:[(0,a.jsx)(s.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(s.span,{className:"mfrac",children:(0,a.jsxs)(s.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(s.span,{className:"vlist-r",children:[(0,a.jsxs)(s.span,{className:"vlist",style:{height:"0.8557em"},children:[(0,a.jsxs)(s.span,{style:{top:"-2.655em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02691em"},children:"w"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"d"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"t"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"h"}),(0,a.jsx)(s.span,{className:"mbin mtight",children:"\xd7"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"h"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"e"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"g"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"h"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"t"})]})})]}),(0,a.jsxs)(s.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(s.span,{style:{top:"-3.394em"},children:[(0,a.jsx)(s.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(s.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(s.span,{className:"mord mtight",children:[(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"s"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"i"}),(0,a.jsx)(s.span,{className:"mord mathnormal mtight",children:"ze"})]})})]})]}),(0,a.jsx)(s.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(s.span,{className:"vlist-r",children:(0,a.jsx)(s.span,{className:"vlist",style:{height:"0.4811em"},children:(0,a.jsx)(s.span,{})})})]})}),(0,a.jsx)(s.span,{className:"mclose nulldelimiter"})]})]})]})]})]}),"\n",(0,a.jsxs)(s.p,{children:["If ",(0,a.jsx)(s.code,{children:"solidity"})," is low (i.e., bounding box large but region sparse), treat as small/noisy and merge."]}),"\n",(0,a.jsx)(s.h2,{id:"parallel-labeling",children:"Parallel labeling"}),"\n",(0,a.jsx)(s.p,{children:"Use segmented image tiling with boundary stitching for multicore scaling or specialized GPU approaches."})]})}function d(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);