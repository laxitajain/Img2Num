(function(){"use strict";async function Je(rr={}){var V,t=rr,fe=typeof window=="object",E=typeof WorkerGlobalScope<"u";typeof process=="object"&&process.versions?.node&&process.type!="renderer";var v=E&&self.name?.startsWith("em-pthread"),le=(e,r)=>{throw r},nr=self.location.href,O="";function tr(e){return t.locateFile?t.locateFile(e,O):O+e}var ue,x;if(fe||E){try{O=new URL(".",nr).href}catch{}E&&(x=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),ue=async e=>{var r=await fetch(e,{credentials:"same-origin"});if(r.ok)return r.arrayBuffer();throw new Error(r.status+" : "+r.url)}}var K=console.log.bind(console),m=console.error.bind(console),W,A,U=!1,T;function f(){g.buffer!=p.buffer&&B()}var z,ce,ve;if(v){let e=function(r){try{var n=r.data,i=n.cmd;if(i==="load"){let o=[];self.onmessage=s=>o.push(s),ve=()=>{postMessage({cmd:"loaded"});for(let s of o)e(s);self.onmessage=e};for(const s of n.handlers)(!t[s]||t[s].proxy)&&(t[s]=(...a)=>{postMessage({cmd:"callHandler",handler:s,args:a})},s=="print"&&(K=t[s]),s=="printErr"&&(m=t[s]));g=n.wasmMemory,B(),A=n.wasmModule,me(),j()}else if(i==="run"){pr(n.pthread_ptr),ie(n.pthread_ptr,0,0,1,0,0),u.threadInitTLS(),ne(n.pthread_ptr),X||(X=!0);try{br(n.start_routine,n.arg)}catch(o){if(o!="unwind")throw o}}else n.target==="setimmediate"||(i==="checkMailbox"?X&&L():i&&(m(`worker: received unknown command ${i}`),m(n)))}catch(o){throw Oe(),o}};var X=!1;self.onunhandledrejection=r=>{throw r.reason||r},self.onmessage=e}var g,p,R,Y,M,d,G,S,b,de=!1,Q=!1;function B(){var e=g.buffer;p=new Int8Array(e),Y=new Int16Array(e),t.HEAPU8=R=new Uint8Array(e),t.HEAP32=M=new Int32Array(e),d=new Uint32Array(e),G=new Float32Array(e),S=new Float64Array(e),b=new BigInt64Array(e),new BigUint64Array(e)}function ar(){if(!v){if(t.wasmMemory)g=t.wasmMemory;else{var e=t.INITIAL_MEMORY||1073741824;g=new WebAssembly.Memory({initial:e/65536,maximum:32768,shared:!0})}B()}}function ir(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)ke(t.preRun.shift());be(we)}function _e(){if(de=!0,v)return ve();k.r()}function sr(){v||(Ve(),Or(),u.terminateAllThreads(),Q=!0)}function or(){if(!v){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)mr(t.postRun.shift());be(Me)}}function F(e){t.onAbort?.(e),e="Aborted("+e+")",m(e),U=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw ce?.(r),r}var D;function fr(){return t.locateFile?tr("index.wasm"):new URL("/Img2Num/assets/index-Xv34nsE8.wasm",self.location.href).href}function lr(e){if(e==D&&W)return new Uint8Array(W);if(x)return x(e);throw"both async and sync fetching of the wasm failed"}async function ur(e){if(!W)try{var r=await ue(e);return new Uint8Array(r)}catch{}return lr(e)}async function cr(e,r){try{var n=await ur(e),i=await WebAssembly.instantiate(n,r);return i}catch(o){m(`failed to asynchronously prepare wasm: ${o}`),F(o)}}async function vr(e,r,n){if(!e)try{var i=fetch(r,{credentials:"same-origin"}),o=await WebAssembly.instantiateStreaming(i,n);return o}catch(s){m(`wasm streaming compile failed: ${s}`),m("falling back to ArrayBuffer instantiation")}return cr(r,n)}function he(){return en(),{a:Ze}}async function me(){function e(a,l){return k=a.exports,wr(k.A),Pe=k.t,A=l,Jr(k),k}function r(a){return e(a.instance,a.module)}var n=he();if(t.instantiateWasm)return new Promise((a,l)=>{t.instantiateWasm(n,(c,_)=>{a(e(c,_))})});if(v){var i=new WebAssembly.Instance(A,he());return e(i,A)}D??=fr();var o=await vr(W,D,n),s=r(o);return s}class pe{name="ExitStatus";constructor(r){this.message=`Program terminated with exit(${r})`,this.status=r}}var ge=e=>{e.terminate(),e.onmessage=r=>{}},ye=e=>{var r=u.pthreads[e];u.returnWorkerToPool(r)},be=e=>{for(;e.length>0;)e.shift()(t)},we=[],ke=e=>we.push(e),w=0,P=null,dr=e=>{if(w--,t.monitorRunDependencies?.(w),w==0&&P){var r=P;P=null,r()}},_r=e=>{w++,t.monitorRunDependencies?.(w)},Te=e=>{var r=u.getNewWorker();if(!r)return 6;u.runningWorkers.push(r),u.pthreads[e.pthread_ptr]=r,r.pthread_ptr=e.pthread_ptr;var n={cmd:"run",start_routine:e.startRoutine,arg:e.arg,pthread_ptr:e.pthread_ptr};return r.postMessage(n,e.transferList),0},Z=0,N=()=>re||Z>0,Re=()=>De(),q=e=>Ge(e),J=e=>Qe(e),C=(e,r,n,...i)=>{for(var o=i.length*2,s=Re(),a=J(o*8),l=a>>3,c=0;c<i.length;c++){var _=i[c];typeof _=="bigint"?((f(),b)[l+2*c]=1n,(f(),b)[l+2*c+1]=_):((f(),b)[l+2*c]=0n,(f(),S)[l+2*c+1]=_)}var y=Ke(e,r,o,a,n);return q(s),y};function We(e){if(v)return C(0,0,1,e);T=e,N()||(u.terminateAllThreads(),t.onExit?.(e),U=!0),le(e,new pe(e))}function Ae(e){if(v)return C(1,0,0,e);ee(e)}var hr=(e,r)=>{if(T=e,v)throw Ae(e),"unwind";N()||sr(),We(e)},ee=hr,u={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init(){v||u.initMainThread()},initMainThread(){for(var e=8;e--;)u.allocateUnusedWorker();ke(async()=>{var r=u.loadWasmModuleToAllWorkers();_r(),await r,dr()})},terminateAllThreads:()=>{for(var e of u.runningWorkers)ge(e);for(var e of u.unusedWorkers)ge(e);u.unusedWorkers=[],u.runningWorkers=[],u.pthreads={}},returnWorkerToPool:e=>{var r=e.pthread_ptr;delete u.pthreads[r],u.unusedWorkers.push(e),u.runningWorkers.splice(u.runningWorkers.indexOf(e),1),e.pthread_ptr=0,ze(r)},threadInitTLS(){u.tlsInitFunctions.forEach(e=>e())},loadWasmModuleToWorker:e=>new Promise(r=>{e.onmessage=s=>{var a=s.data,l=a.cmd;if(a.targetThread&&a.targetThread!=$()){var c=u.pthreads[a.targetThread];c?c.postMessage(a,a.transferList):m(`Internal error! Worker sent a message "${l}" to target pthread ${a.targetThread}, but that thread no longer exists!`);return}l==="checkMailbox"?L():l==="spawnThread"?Te(a):l==="cleanupThread"?Fe(()=>ye(a.thread)):l==="loaded"?(e.loaded=!0,r(e)):a.target==="setimmediate"?e.postMessage(a):l==="callHandler"?t[a.handler](...a.args):l&&m(`worker sent an unknown command ${l}`)},e.onerror=s=>{var a="worker sent an error!";throw m(`${a} ${s.filename}:${s.lineno}: ${s.message}`),s};var n=[],i=["onExit","onAbort","print","printErr"];for(var o of i)t.propertyIsEnumerable(o)&&n.push(o);e.postMessage({cmd:"load",handlers:n,wasmMemory:g,wasmModule:A})}),async loadWasmModuleToAllWorkers(){return v?void 0:Promise.all(u.unusedWorkers.map(u.loadWasmModuleToWorker))},allocateUnusedWorker(){var e;if(t.mainScriptUrlOrBlob){var r=t.mainScriptUrlOrBlob;typeof r!="string"&&(r=URL.createObjectURL(r)),e=new Worker(r,{type:"module",name:"em-pthread"})}else e=new Worker(self.location.href,{type:"module",name:"em-pthread"});u.unusedWorkers.push(e)},getNewWorker(){return u.unusedWorkers.length==0&&(u.allocateUnusedWorker(),u.loadWasmModuleToWorker(u.unusedWorkers[0])),u.unusedWorkers.pop()}},Me=[],mr=e=>Me.push(e);function pr(e){var r=(f(),d)[e+52>>2],n=(f(),d)[e+56>>2],i=r-n;Ye(r,i),q(r)}function gr(e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":return(f(),p)[e];case"i8":return(f(),p)[e];case"i16":return(f(),Y)[e>>1];case"i32":return(f(),M)[e>>2];case"i64":return(f(),b)[e>>3];case"float":return(f(),G)[e>>2];case"double":return(f(),S)[e>>3];case"*":return(f(),d)[e>>2];default:F(`invalid type for getValue: ${r}`)}}var Se=[],Pe,yr=e=>{var r=Se[e];return r||(Se[e]=r=Pe.get(e)),r},br=(e,r)=>{Z=0,re=0;var n=yr(e)(r);function i(o){if(N()){T=o;return}se(o)}i(n)},re=!1,wr=e=>u.tlsInitFunctions.push(e);function kr(e,r,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":(f(),p)[e]=r;break;case"i8":(f(),p)[e]=r;break;case"i16":(f(),Y)[e>>1]=r;break;case"i32":(f(),M)[e>>2]=r;break;case"i64":(f(),b)[e>>3]=BigInt(r);break;case"float":(f(),G)[e>>2]=r;break;case"double":(f(),S)[e>>3]=r;break;case"*":(f(),d)[e>>2]=r;break;default:F(`invalid type for setValue: ${n}`)}}class Tr{constructor(r){this.excPtr=r,this.ptr=r-24}set_type(r){(f(),d)[this.ptr+4>>2]=r}get_type(){return(f(),d)[this.ptr+4>>2]}set_destructor(r){(f(),d)[this.ptr+8>>2]=r}get_destructor(){return(f(),d)[this.ptr+8>>2]}set_caught(r){r=r?1:0,(f(),p)[this.ptr+12]=r}get_caught(){return(f(),p)[this.ptr+12]!=0}set_rethrown(r){r=r?1:0,(f(),p)[this.ptr+13]=r}get_rethrown(){return(f(),p)[this.ptr+13]!=0}init(r,n){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(n)}set_adjusted_ptr(r){(f(),d)[this.ptr+16>>2]=r}get_adjusted_ptr(){return(f(),d)[this.ptr+16>>2]}}var Ie=0,Rr=(e,r,n)=>{var i=new Tr(e);throw i.init(r,n),Ie=e,Ie};function Ee(e,r,n,i){return v?C(2,0,1,e,r,n,i):Ue(e,r,n,i)}var Wr=()=>typeof SharedArrayBuffer<"u",Ue=(e,r,n,i)=>{if(!Wr())return 6;var o=[],s=0;if(v&&(o.length===0||s))return Ee(e,r,n,i);var a={startRoutine:n,pthread_ptr:e,arg:i,transferList:o};return v?(a.cmd="spawnThread",postMessage(a,o),0):Te(a)},Ar=()=>F(""),Mr=e=>{ie(e,!E,1,!fe,65536,!1),u.threadInitTLS()},Be=e=>{if(e instanceof pe||e=="unwind")return T;le(1,e)},Sr=()=>{if(!Q&&!N())try{if(v){$()&&se(T);return}ee(T)}catch(e){Be(e)}},Fe=e=>{if(!(Q||U))try{e(),Sr()}catch(r){Be(r)}},ne=e=>{if(typeof Atomics.waitAsync=="function"){var r=Atomics.waitAsync((f(),M),e>>2,e);r.value.then(L);var n=e+128;Atomics.store((f(),M),n>>2,1)}},L=()=>Fe(()=>{var e=$();e&&(ne(e),Xe())}),Pr=(e,r)=>{if(e==r)setTimeout(L);else if(v)postMessage({targetThread:e,cmd:"checkMailbox"});else{var n=u.pthreads[e];if(!n)return;n.postMessage({cmd:"checkMailbox"})}},H=[],Ir=(e,r,n,i,o)=>{i/=2,H.length=i;for(var s=o>>3,a=0;a<i;a++)(f(),b)[s+2*a]?H[a]=(f(),b)[s+2*a+1]:H[a]=(f(),S)[s+2*a+1];var l=qr[e];u.currentProxiedOperationCallerThread=n;var c=l(...H);return u.currentProxiedOperationCallerThread=0,c},Er=e=>{v?postMessage({cmd:"cleanupThread",thread:e}):ye(e)},Ur=e=>{},Br=()=>performance.timeOrigin+performance.now(),Fr=()=>{},Nr=()=>{Z+=1},Cr=()=>{throw Nr(),"unwind"},Lr=()=>2147483648,Hr=(e,r)=>Math.ceil(e/r)*r,$r=e=>{var r=g.buffer.byteLength,n=(e-r+65535)/65536|0;try{return g.grow(n),B(),1}catch{}},jr=e=>{var r=(f(),R).length;if(e>>>=0,e<=r)return!1;var n=Lr();if(e>n)return!1;for(var i=1;i<=4;i*=2){var o=r*(1+.2/i);o=Math.min(o,e+100663296);var s=Math.min(n,Hr(Math.max(e,o),65536)),a=$r(s);if(a)return!0}return!1},te=[null,[],[]],Ne=typeof TextDecoder<"u"?new TextDecoder:void 0,Vr=(e,r,n,i)=>{for(var o=r+n;e[r]&&!(r>=o);)++r;return r},Ce=(e,r=0,n,i)=>{var o=Vr(e,r,n);if(o-r>16&&e.buffer&&Ne)return Ne.decode(e.buffer instanceof ArrayBuffer?e.subarray(r,o):e.slice(r,o));for(var s="";r<o;){var a=e[r++];if(!(a&128)){s+=String.fromCharCode(a);continue}var l=e[r++]&63;if((a&224)==192){s+=String.fromCharCode((a&31)<<6|l);continue}var c=e[r++]&63;if((a&240)==224?a=(a&15)<<12|l<<6|c:a=(a&7)<<18|l<<12|c<<6|e[r++]&63,a<65536)s+=String.fromCharCode(a);else{var _=a-65536;s+=String.fromCharCode(55296|_>>10,56320|_&1023)}}return s},ae=(e,r)=>{var n=te[e];r===0||r===10?((e===1?K:m)(Ce(n)),n.length=0):n.push(r)},Or=()=>{xe(0),te[1].length&&ae(1,10),te[2].length&&ae(2,10)},xr=(e,r,n)=>e?Ce((f(),R),e,r):"";function Le(e,r,n,i){if(v)return C(3,0,1,e,r,n,i);for(var o=0,s=0;s<n;s++){var a=(f(),d)[r>>2],l=(f(),d)[r+4>>2];r+=8;for(var c=0;c<l;c++)ae(e,(f(),R)[a+c]);o+=l}return(f(),d)[i>>2]=o,0}var Kr=()=>e=>e.set(crypto.getRandomValues(new Uint8Array(e.byteLength))),He=e=>{(He=Kr())(e)},zr=(e,r)=>(He((f(),R).subarray(e,e+r)),0),$e=e=>{var r=t["_"+e];return r},Xr=(e,r)=>{(f(),p).set(e,r)},Yr=e=>{for(var r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i<=127?r++:i<=2047?r+=2:i>=55296&&i<=57343?(r+=4,++n):r+=3}return r},Gr=(e,r,n,i)=>{if(!(i>0))return 0;for(var o=n,s=n+i-1,a=0;a<e.length;++a){var l=e.codePointAt(a);if(l<=127){if(n>=s)break;r[n++]=l}else if(l<=2047){if(n+1>=s)break;r[n++]=192|l>>6,r[n++]=128|l&63}else if(l<=65535){if(n+2>=s)break;r[n++]=224|l>>12,r[n++]=128|l>>6&63,r[n++]=128|l&63}else{if(n+3>=s)break;r[n++]=240|l>>18,r[n++]=128|l>>12&63,r[n++]=128|l>>6&63,r[n++]=128|l&63,a++}}return r[n]=0,n-o},Qr=(e,r,n)=>Gr(e,(f(),R),r,n),Dr=e=>{var r=Yr(e)+1,n=J(r);return Qr(e,n,r),n},je=(e,r,n,i,o)=>{var s={string:h=>{var I=0;return h!=null&&h!==0&&(I=Dr(h)),I},array:h=>{var I=J(h.length);return Xr(h,I),I}};function a(h){return r==="string"?xr(h):r==="boolean"?!!h:h}var l=$e(e),c=[],_=0;if(i)for(var y=0;y<i.length;y++){var qe=s[n[y]];qe?(_===0&&(_=Re()),c[y]=qe(i[y])):c[y]=i[y]}var oe=l(...c);function rn(h){return _!==0&&q(_),a(h)}return oe=rn(oe),oe},Zr=(e,r,n,i)=>{var o=!n||n.every(a=>a==="number"||a==="boolean"),s=r!=="string";return s&&o&&!i?$e(e):(...a)=>je(e,r,n,a)};if(u.init(),ar(),t.noExitRuntime&&(re=t.noExitRuntime),t.print&&(K=t.print),t.printErr&&(m=t.printErr),t.wasmBinary&&(W=t.wasmBinary),t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.shift()();t.ccall=je,t.cwrap=Zr,t.setValue=kr,t.getValue=gr;var qr=[We,Ae,Ee,Le],$,Ve,ie,Oe,xe,Ke,ze,se,Xe,Ye,Ge,Qe,De;function Jr(e){t._bilateral_filter=e.s,t._gaussian_blur_fft=e.u,t._invert_image=e.v,t._threshold_image=e.w,t._black_threshold_image=e.x,t._kmeans=e.y,t._kmeans_clustering_graph=e.z,e.A,$=e.B,Ve=e.C,ie=e.D,Oe=e.E,xe=e.F,t._malloc=e.G,t._free=e.H,Ke=e.I,ze=e.J,se=e.K,Xe=e.L,Ye=e.M,Ge=e.N,Qe=e.O,De=e.P}var Ze;function en(){Ze={b:Rr,g:Ue,n:Ar,j:Mr,p:Pr,h:Ir,d:Er,i:ne,l:Ur,e:Fr,k:Cr,c:Br,o:jr,q:ee,f:Le,a:g,m:zr}}function j(){if(w>0){P=j;return}if(v){z?.(t),_e();return}if(ir(),w>0){P=j;return}function e(){t.calledRun=!0,!U&&(_e(),z?.(t),t.onRuntimeInitialized?.(),or())}t.setStatus?(t.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>t.setStatus(""),1),e()},1)):e()}var k;return v||(k=await me(),j()),de?V=t:V=new Promise((e,r)=>{z=e,ce=r}),V}var er=globalThis.self?.name?.startsWith("em-pthread");er&&Je()})();
